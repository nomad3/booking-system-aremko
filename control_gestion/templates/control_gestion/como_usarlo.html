{% extends "control_gestion/base_control.html" %}

{% block title %}CÃ³mo Usar Control de GestiÃ³n{% endblock %}

{% block extra_head %}
<style>
    .doc-container {
        max-width: 1000px;
        margin: 0 auto;
    }

    .doc-section {
        background: white;
        padding: 30px;
        margin-bottom: 25px;
        border-radius: 8px;
        box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }

    .doc-section h2 {
        color: #2c3e50;
        margin-bottom: 20px;
        padding-bottom: 10px;
        border-bottom: 3px solid #3498db;
    }

    .doc-section h3 {
        color: #34495e;
        margin-top: 25px;
        margin-bottom: 15px;
        font-size: 20px;
    }

    .role-badge {
        display: inline-block;
        padding: 5px 12px;
        border-radius: 20px;
        font-size: 12px;
        font-weight: 600;
        margin-bottom: 10px;
    }

    .role-admin {
        background: #e74c3c;
        color: white;
    }

    .role-supervisor {
        background: #f39c12;
        color: white;
    }

    .role-user {
        background: #3498db;
        color: white;
    }

    .example-box {
        background: #ecf0f1;
        padding: 15px;
        border-radius: 6px;
        margin: 15px 0;
        border-left: 4px solid #3498db;
    }

    .example-box strong {
        color: #2c3e50;
    }

    .step-list {
        list-style: none;
        counter-reset: step-counter;
        padding-left: 0;
    }

    .step-list li {
        counter-increment: step-counter;
        margin-bottom: 15px;
        padding-left: 40px;
        position: relative;
    }

    .step-list li:before {
        content: counter(step-counter);
        position: absolute;
        left: 0;
        top: 0;
        background: #3498db;
        color: white;
        width: 28px;
        height: 28px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-weight: bold;
        font-size: 14px;
    }

    .feature-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        gap: 15px;
        margin: 20px 0;
    }

    .feature-card {
        background: #f8f9fa;
        padding: 15px;
        border-radius: 6px;
        border: 1px solid #dee2e6;
    }

    .feature-card h4 {
        color: #2c3e50;
        font-size: 16px;
        margin-bottom: 8px;
    }

    .feature-card p {
        color: #7f8c8d;
        font-size: 14px;
        margin: 0;
    }

    .workflow-diagram {
        background: #fff;
        padding: 20px;
        border: 2px dashed #3498db;
        border-radius: 8px;
        margin: 20px 0;
        text-align: center;
    }

    .workflow-step {
        display: inline-block;
        padding: 10px 20px;
        background: #3498db;
        color: white;
        border-radius: 6px;
        margin: 5px;
        font-weight: 600;
    }

    .workflow-arrow {
        display: inline-block;
        color: #3498db;
        font-size: 24px;
        margin: 0 10px;
    }

    .alert-info {
        background: #d1ecf1;
        border: 1px solid #bee5eb;
        color: #0c5460;
        padding: 15px;
        border-radius: 6px;
        margin: 15px 0;
    }

    .alert-warning {
        background: #fff3cd;
        border: 1px solid #ffeaa7;
        color: #856404;
        padding: 15px;
        border-radius: 6px;
        margin: 15px 0;
    }

    code {
        background: #2c3e50;
        color: #ecf0f1;
        padding: 2px 6px;
        border-radius: 3px;
        font-family: 'Courier New', monospace;
        font-size: 13px;
    }

    .back-button {
        display: inline-block;
        padding: 10px 20px;
        background: #95a5a6;
        color: white;
        text-decoration: none;
        border-radius: 6px;
        margin-bottom: 20px;
        transition: background 0.3s;
    }

    .back-button:hover {
        background: #7f8c8d;
        color: white;
        text-decoration: none;
    }
</style>
{% endblock %}

{% block content %}
<div class="doc-container">
    <a href="/admin/" class="back-button">â† Volver al Dashboard</a>

    <div class="doc-section">
        <h2>ğŸ“š CÃ³mo Usar el Sistema de Control de GestiÃ³n</h2>
        <p style="font-size: 16px; color: #7f8c8d; margin-bottom: 0;">
            GuÃ­a completa para administradores, supervisores y usuarios del sistema de tareas operativas de Aremko.
        </p>
    </div>

    <!-- SecciÃ³n 1: IntroducciÃ³n -->
    <div class="doc-section">
        <h2>ğŸ¯ Â¿QuÃ© es Control de GestiÃ³n?</h2>

        <p>El sistema de Control de GestiÃ³n es una herramienta diseÃ±ada para organizar y gestionar todas las tareas operativas del dÃ­a a dÃ­a en Aremko. Funciona bajo el principio <strong>WIP-1</strong> (Work In Progress = 1), lo que significa que cada persona debe tener <strong>mÃ¡ximo 1 tarea en curso</strong> a la vez.</p>

        <div class="feature-grid">
            <div class="feature-card">
                <h4>ğŸ“‹ Tareas Organizadas</h4>
                <p>Cada tarea estÃ¡ asignada a un Ã¡rea especÃ­fica (swimlane) y tiene prioridad definida.</p>
            </div>
            <div class="feature-card">
                <h4>ğŸ”„ Flujo de Trabajo</h4>
                <p>Las tareas avanzan de Por Ejecutar â†’ En Curso â†’ Hecha, con reglas claras.</p>
            </div>
            <div class="feature-card">
                <h4>ğŸ¤– AutomatizaciÃ³n</h4>
                <p>Plantillas automÃ¡ticas para tareas rutinarias (preparaciÃ³n servicios, vaciado tinas, etc.)</p>
            </div>
            <div class="feature-card">
                <h4>ğŸ“Š Reportes IA</h4>
                <p>Reportes diarios generados automÃ¡ticamente con inteligencia artificial.</p>
            </div>
        </div>
    </div>

    <!-- SecciÃ³n 2: Roles y Permisos -->
    <div class="doc-section">
        <h2>ğŸ‘¥ Roles y Permisos</h2>

        <h3><span class="role-badge role-admin">ADMINISTRADOR</span></h3>
        <p><strong>Puede:</strong></p>
        <ul>
            <li>âœ… Crear, editar y eliminar tareas de cualquier usuario</li>
            <li>âœ… Configurar plantillas de tareas automÃ¡ticas</li>
            <li>âœ… Ver todos los reportes y estadÃ­sticas</li>
            <li>âœ… Reasignar tareas entre usuarios</li>
            <li>âœ… Cambiar prioridades y fechas de promesa</li>
            <li>âœ… Acceder al Admin de Django</li>
        </ul>

        <h3><span class="role-badge role-supervisor">SUPERVISOR</span></h3>
        <p><strong>Puede:</strong></p>
        <ul>
            <li>âœ… Ver tareas de todo el equipo</li>
            <li>âœ… Cambiar estado de tareas de otros</li>
            <li>âœ… Ver indicadores y reportes</li>
            <li>âœ… Crear tareas para otros usuarios</li>
            <li>âš ï¸ No puede eliminar tareas ni configurar plantillas</li>
        </ul>

        <h3><span class="role-badge role-user">USUARIO</span></h3>
        <p><strong>Puede:</strong></p>
        <ul>
            <li>âœ… Ver sus propias tareas en "Mi DÃ­a"</li>
            <li>âœ… Marcar sus tareas como "En Curso" o "Hecha"</li>
            <li>âœ… Completar checklist de sus tareas</li>
            <li>âœ… Agregar notas y comentarios</li>
            <li>âŒ No puede crear tareas nuevas</li>
            <li>âŒ No puede cambiar tareas de otros</li>
        </ul>
    </div>

    <!-- SecciÃ³n 3: Para Administradores -->
    <div class="doc-section">
        <h2>âš™ï¸ GuÃ­a para Administradores</h2>

        <h3>1. Configurar Plantillas de Tareas AutomÃ¡ticas</h3>

        <p><strong>UbicaciÃ³n:</strong> <a href="/control_gestion/plantillas/">Control de GestiÃ³n > Plantillas</a></p>

        <div class="example-box">
            <strong>Ejemplo: PreparaciÃ³n de Servicios</strong><br>
            Crear una plantilla que automÃ¡ticamente genere tareas de preparaciÃ³n 2 horas antes de cada reserva.
        </div>

        <ol class="step-list">
            <li>Ir a "Plantillas" en el dashboard</li>
            <li>Click en "Crear Nueva Plantilla"</li>
            <li>Configurar:
                <ul>
                    <li><code>Nombre</code>: "PreparaciÃ³n Tina Hidro"</li>
                    <li><code>Tipo</code>: "PreparaciÃ³n de Servicio"</li>
                    <li><code>Swimlane</code>: "OperaciÃ³n"</li>
                    <li><code>AnticipaciÃ³n</code>: 120 minutos (2 horas)</li>
                    <li><code>Activa</code>: SÃ­</li>
                </ul>
            </li>
            <li>Guardar plantilla</li>
        </ol>

        <div class="alert-info">
            ğŸ’¡ <strong>Tip:</strong> Las plantillas se ejecutan automÃ¡ticamente vÃ­a Cron Jobs en Render. Verifica que los Cron Jobs estÃ©n configurados correctamente.
        </div>

        <h3>2. Gestionar Disponibilidad de Empleados</h3>

        <div class="example-box">
            <strong>Ejemplo: Configurar turnos</strong><br>
            Ana trabaja de Lunes a Viernes 9:00-18:00. Pedro trabaja fines de semana 10:00-19:00.
        </div>

        <ol class="step-list">
            <li>Ir a Admin Django > Control de GestiÃ³n > Empleado Disponibilidad</li>
            <li>Crear registro para Ana:
                <ul>
                    <li><code>Empleado</code>: Ana</li>
                    <li><code>DÃ­a</code>: Lunes</li>
                    <li><code>Hora Inicio</code>: 09:00</li>
                    <li><code>Hora Fin</code>: 18:00</li>
                    <li><code>Activo</code>: SÃ­</li>
                </ul>
            </li>
            <li>Repetir para cada dÃ­a de la semana</li>
        </ol>

        <div class="alert-warning">
            âš ï¸ <strong>Importante:</strong> Las tareas solo se asignan a usuarios que tengan disponibilidad configurada para el horario de la tarea.
        </div>

        <h3>3. Monitorear el Sistema</h3>

        <div class="feature-grid">
            <div class="feature-card">
                <h4>ğŸ“Š Indicadores</h4>
                <p>Ver eficiencia por persona y Ã¡rea, promesas cumplidas, tareas bloqueadas >24h.</p>
                <a href="/control_gestion/indicadores/">Ver Indicadores â†’</a>
            </div>
            <div class="feature-card">
                <h4>ğŸ“ˆ Reportes Diarios</h4>
                <p>Reportes generados con IA 2 veces al dÃ­a (matutino y vespertino).</p>
                <a href="/control_gestion/reportes/">Ver Reportes â†’</a>
            </div>
            <div class="feature-card">
                <h4>ğŸ‘¥ Vista Equipo</h4>
                <p>Ver todas las tareas del equipo del dÃ­a, filtrar por Ã¡rea.</p>
                <a href="/control_gestion/equipo/">Ver Equipo â†’</a>
            </div>
        </div>
    </div>

    <!-- SecciÃ³n 4: Para Usuarios -->
    <div class="doc-section">
        <h2>ğŸ“± GuÃ­a para Usuarios</h2>

        <h3>Flujo de Trabajo Diario</h3>

        <div class="workflow-diagram">
            <div class="workflow-step">1. Abrir "Mi DÃ­a"</div>
            <span class="workflow-arrow">â†’</span>
            <div class="workflow-step">2. Tomar 1ra tarea</div>
            <span class="workflow-arrow">â†’</span>
            <div class="workflow-step">3. Completar</div>
            <span class="workflow-arrow">â†’</span>
            <div class="workflow-step">4. Siguiente</div>
        </div>

        <h3>1. Revisar "Mi DÃ­a" (MaÃ±ana y varias veces al dÃ­a)</h3>

        <ol class="step-list">
            <li>Acceder a <a href="/control_gestion/mi-dia/">Mi DÃ­a</a></li>
            <li>Ver las <strong>3 tareas top</strong> que debes hacer hoy</li>
            <li>Las tareas estÃ¡n ordenadas por prioridad automÃ¡ticamente</li>
        </ol>

        <h3>2. Trabajar en una Tarea (Regla WIP-1)</h3>

        <ol class="step-list">
            <li><strong>Tomar la primera tarea</strong> de tu lista (la de mÃ¡s arriba)</li>
            <li>Click en "Cambiar a EN CURSO" (botÃ³n azul)</li>
            <li>Completar el checklist paso a paso</li>
            <li>Cuando termines: Click en "Marcar como HECHA" (botÃ³n verde)</li>
        </ol>

        <div class="alert-info">
            ğŸ’¡ <strong>Regla de Oro:</strong> Solo puedes tener <strong>1 tarea EN CURSO</strong> a la vez. Si necesitas dejar una tarea, mÃ¡rcala como "Bloqueada" y explica el motivo en las notas.
        </div>

        <h3>3. Completar Checklist</h3>

        <div class="example-box">
            <strong>Ejemplo: Preparar Tina 4 para Cliente VIP</strong><br><br>
            <input type="checkbox" checked> Verificar temperatura agua (38-40Â°C)<br>
            <input type="checkbox" checked> Agregar sales aromÃ¡ticas<br>
            <input type="checkbox"> Colocar toallas limpias<br>
            <input type="checkbox"> Verificar luces ambientales<br>
            <input type="checkbox"> Limpiar Ã¡rea alrededor de tina
        </div>

        <p>Marca cada Ã­tem al completarlo. Todos deben estar âœ… antes de marcar la tarea como Hecha.</p>

        <h3>4. Agregar Notas (Si es necesario)</h3>

        <div class="example-box">
            <strong>Ejemplo de nota Ãºtil:</strong><br>
            "Cliente pidiÃ³ temperatura mÃ¡s baja (36Â°C). Ajustado segÃºn preferencia."
        </div>

        <p>Las notas ayudan al equipo a entender detalles importantes de la tarea.</p>
    </div>

    <!-- SecciÃ³n 5: Estados de Tareas -->
    <div class="doc-section">
        <h2>ğŸ”„ Estados de las Tareas</h2>

        <div class="feature-grid">
            <div class="feature-card" style="border-left: 4px solid #95a5a6;">
                <h4>ğŸ“‹ BACKLOG</h4>
                <p><strong>Significado:</strong> Tarea pendiente, aÃºn no iniciada.</p>
                <p><strong>QuÃ© hacer:</strong> Esperar tu turno. Cuando termines la tarea actual, esta pasarÃ¡ a ser la siguiente.</p>
            </div>

            <div class="feature-card" style="border-left: 4px solid #3498db;">
                <h4>âš™ï¸ EN CURSO</h4>
                <p><strong>Significado:</strong> EstÃ¡s trabajando en esta tarea AHORA.</p>
                <p><strong>Regla:</strong> Solo 1 tarea en curso por persona a la vez.</p>
            </div>

            <div class="feature-card" style="border-left: 4px solid #e74c3c;">
                <h4>ğŸš« BLOQUEADA</h4>
                <p><strong>Significado:</strong> No puedes avanzar por algÃºn motivo externo.</p>
                <p><strong>QuÃ© hacer:</strong> Agregar nota explicando el bloqueo. Pasar a la siguiente tarea.</p>
            </div>

            <div class="feature-card" style="border-left: 4px solid #27ae60;">
                <h4>âœ… HECHA</h4>
                <p><strong>Significado:</strong> Tarea completada exitosamente.</p>
                <p><strong>Resultado:</strong> La tarea desaparece de "Mi DÃ­a". Siguiente tarea sube automÃ¡ticamente.</p>
            </div>
        </div>
    </div>

    <!-- SecciÃ³n 6: Tipos de Tareas -->
    <div class="doc-section">
        <h2>ğŸ“ Tipos de Tareas</h2>

        <h3>1. Tareas de PreparaciÃ³n de Servicios</h3>
        <p>Se crean <strong>automÃ¡ticamente 2 horas antes</strong> de cada reserva.</p>
        <div class="example-box">
            <strong>Ejemplo:</strong><br>
            Reserva: Tina Hidro a las 15:00<br>
            â†’ Tarea creada automÃ¡ticamente a las 13:00<br>
            â†’ Asignada a usuario de OperaciÃ³n con disponibilidad
        </div>

        <h3>2. Tareas de Vaciado de Tinas</h3>
        <p>Se crean <strong>automÃ¡ticamente 30 minutos despuÃ©s</strong> de finalizar un servicio.</p>
        <div class="example-box">
            <strong>Ejemplo:</strong><br>
            Servicio termina: 16:00<br>
            â†’ Tarea de vaciado creada a las 16:30<br>
            â†’ Asignada a usuario de OperaciÃ³n
        </div>

        <h3>3. Tareas de Apertura Diaria</h3>
        <p>Se crean <strong>automÃ¡ticamente cada dÃ­a a las 7:00 AM</strong> para preparar las instalaciones.</p>

        <h3>4. Tareas Manuales</h3>
        <p>Creadas por admin/supervisor para casos especiales.</p>
        <div class="example-box">
            <strong>Ejemplo:</strong><br>
            "Reparar puerta de CabaÃ±a 3"<br>
            "Comprar insumos de limpieza"
        </div>
    </div>

    <!-- SecciÃ³n 7: Ãreas (Swimlanes) -->
    <div class="doc-section">
        <h2>ğŸŠ Ãreas de Trabajo (Swimlanes)</h2>

        <p>Cada tarea pertenece a un Ã¡rea especÃ­fica:</p>

        <div class="feature-grid">
            <div class="feature-card">
                <h4>ğŸ’¼ Comercial</h4>
                <p>Ventas, cotizaciones, seguimiento de leads.</p>
            </div>
            <div class="feature-card">
                <h4>ğŸ§ AtenciÃ³n Cliente</h4>
                <p>Consultas, reclamos, encuestas de satisfacciÃ³n.</p>
            </div>
            <div class="feature-card">
                <h4>âš™ï¸ OperaciÃ³n</h4>
                <p>PreparaciÃ³n servicios, vaciado tinas, mantenimiento.</p>
            </div>
            <div class="feature-card">
                <h4>ğŸ“ RecepciÃ³n</h4>
                <p>AtenciÃ³n telefÃ³nica, reservas, check-in.</p>
            </div>
            <div class="feature-card">
                <h4>ğŸ“Š Marketing y SupervisiÃ³n</h4>
                <p>CampaÃ±as, reportes, supervisiÃ³n de equipo.</p>
            </div>
        </div>
    </div>

    <!-- SecciÃ³n 8: Prioridades -->
    <div class="doc-section">
        <h2>âš¡ Prioridades</h2>

        <div class="feature-card" style="border-left: 4px solid #e74c3c; margin-bottom: 15px;">
            <h4>ğŸ”´ ALTA (Cliente en Sitio)</h4>
            <p><strong>Ejemplo:</strong> Cliente en Tina 4 pidiÃ³ cafÃ© urgente.</p>
            <p><strong>AcciÃ³n:</strong> Atender INMEDIATAMENTE. Pausa lo que estÃ©s haciendo.</p>
        </div>

        <div class="feature-card" style="border-left: 4px solid #3498db;">
            <h4>ğŸ”µ NORMAL</h4>
            <p><strong>Ejemplo:</strong> Preparar tina para reserva de las 15:00.</p>
            <p><strong>AcciÃ³n:</strong> Seguir orden de la cola (primera en entrar, primera en salir).</p>
        </div>
    </div>

    <!-- SecciÃ³n 9: Reportes -->
    <div class="doc-section">
        <h2>ğŸ“Š Reportes con IA</h2>

        <p>El sistema genera <strong>automÃ¡ticamente</strong> reportes con inteligencia artificial <strong>2 veces al dÃ­a</strong>:</p>

        <div class="feature-grid">
            <div class="feature-card">
                <h4>ğŸŒ… Reporte Matutino (09:05 AM)</h4>
                <p>Resumen del dÃ­a anterior y planes para hoy.</p>
            </div>
            <div class="feature-card">
                <h4>ğŸŒ† Reporte Vespertino (18:00 PM)</h4>
                <p>Resumen del dÃ­a y prioridades para maÃ±ana.</p>
            </div>
        </div>

        <p><strong>Acceso:</strong> <a href="/control_gestion/reportes/">Control de GestiÃ³n > Reportes</a></p>

        <div class="alert-info">
            ğŸ’¡ <strong>Uso recomendado:</strong> Enviar reportes por WhatsApp/Email al equipo al final del dÃ­a para mantener a todos informados.
        </div>
    </div>

    <!-- SecciÃ³n 10: Preguntas Frecuentes -->
    <div class="doc-section">
        <h2>â“ Preguntas Frecuentes</h2>

        <h3>Â¿QuÃ© hago si tengo 2 tareas urgentes?</h3>
        <p>Solo puedes tener 1 en curso. Si llega una urgencia (cliente en sitio), marca la actual como "Bloqueada" temporalmente, atiende la urgencia, y vuelve a la anterior.</p>

        <h3>Â¿Puedo crear tareas yo mismo como usuario?</h3>
        <p>No. Los usuarios solo pueden trabajar en tareas asignadas. Si necesitas crear una tarea, contacta a tu supervisor o admin.</p>

        <h3>Â¿QuÃ© pasa si una tarea estÃ¡ bloqueada >24 horas?</h3>
        <p>Aparece en los indicadores como "alerta". El supervisor debe resolverla o reasignarla.</p>

        <h3>Â¿DÃ³nde veo el histÃ³rico de mis tareas completadas?</h3>
        <p>Admin Django > Control de GestiÃ³n > Tareas > Filtrar por "Tu usuario" + Estado "Hecha"</p>

        <h3>Â¿Los reportes se generan solos?</h3>
        <p>SÃ­, vÃ­a Cron Jobs en Render. Se ejecutan automÃ¡ticamente a las 09:05 AM y 18:00 PM todos los dÃ­as.</p>
    </div>

    <!-- SecciÃ³n 11: Buenas PrÃ¡cticas -->
    <div class="doc-section">
        <h2>âœ… Buenas PrÃ¡cticas</h2>

        <h3>Para Usuarios:</h3>
        <ul>
            <li>âœ… Revisa "Mi DÃ­a" al inicio de tu turno</li>
            <li>âœ… MÃ¡rcalo tareas como "En Curso" solo cuando empieces a trabajar en ellas</li>
            <li>âœ… Completa el checklist completo antes de marcar como Hecha</li>
            <li>âœ… Agrega notas Ãºtiles si algo fue diferente de lo esperado</li>
            <li>âŒ No dejes tareas "En Curso" sin terminar al final del dÃ­a</li>
        </ul>

        <h3>Para Supervisores:</h3>
        <ul>
            <li>âœ… Revisa "Vista Equipo" varias veces al dÃ­a</li>
            <li>âœ… Atiende tareas bloqueadas rÃ¡pidamente</li>
            <li>âœ… Verifica que no haya usuarios con >1 tarea en curso</li>
            <li>âœ… EnvÃ­a reportes al equipo al final del dÃ­a</li>
        </ul>

        <h3>Para Administradores:</h3>
        <ul>
            <li>âœ… Revisa indicadores semanalmente</li>
            <li>âœ… Ajusta plantillas segÃºn necesidades</li>
            <li>âœ… Verifica que Cron Jobs funcionen correctamente</li>
            <li>âœ… MantÃ©n actualizada la disponibilidad de empleados</li>
        </ul>
    </div>

    <!-- BotÃ³n final -->
    <div style="text-align: center; margin-top: 40px;">
        <a href="/admin/" class="back-button">â† Volver al Dashboard</a>
        <a href="/control_gestion/mi-dia/" class="btn btn-primary" style="padding: 10px 30px; font-size: 16px;">Ir a Mi DÃ­a â†’</a>
    </div>
</div>
{% endblock %}
